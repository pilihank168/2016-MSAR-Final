function y=gaussianFilter(x, fs, filterCoef, showPlot)
% gaussianFilter: Gaussian lowpass filter.
%
%	Usage:
%		y=gaussianFilter(x, fs, filterCoef, showPlot)
%
%	Description:
%		y=gaussianFilter(x, fs, filterCoef, showPlot) returns the output of Gaussian lowpass filter
%			x: input signals
%			fs: sampling rate
%			filterCoef: coefficients of the Gaussian filter (obtained via gaussianFilterCoef.m) 
%
%	Example:
%		x=[0.00103954764771577 0.00093227170528071 0.000712909283771374 0.00126386894069716 0.00151321547308672 0.000742835804665668 0.000589874329521642 0.000443393055180447 0.00100147914484807 0.00198907438429176 0.00251568575793783 0.00164053367898347 0.00218954046203415 0.00514478678593664 0.0124802593649666 0.0156428058851463 0.0128487741745143 0.00751020384015291 0.0038471361880643 0.00401918843279022 0.00574837759307362 0.00573538750989178 0.00407126843998274 0.00292500469426879 0.0017323673545024 0.001383237860811 0.0017212164069005 0.001728430378963 0.00214463045470279 0.00267621118281021 0.00300531429982893 0.00274955867804794 0.00368169125388514 0.00261584449199856 0.00254165163196114 0.00106240572159612 0.00139744197909931 0.00255686430207131 0.00240890836907274 0.00214404570347355 0.00181642548927764 0.00104312688968918 0.00221195818445979 0.00326276528788762 0.00146121062019398 0.00110315177200536 0.00207563822265428 0.00191317067985975 0.00156778857787892 0.0014710377115111 0.00167166060654674 0.00269611531464977 0.00250764599186336 0.00217959043905486 0.00142682836711659 0.000765593650836439 0.000931650893067777 0.00159569907349884 0.00138517404500545 0.0020597270037577 0.00185985500970181 0.00113040520545026 0.000972842521675955 0.00129436863596644 0.00146024771272316 0.00262564625332893 0.00274597810438601 0.00166075942268775 0.00132186864337189 0.00151354936906063 0.00118955018683709 0.00169524441261869 0.00488455277054829 0.00857368152290218 0.0154500294472055 0.0164701214673753 0.0117366881400807 0.00630534252670516 0.00578292207583145 0.00314565845757936 0.00269545171365391 0.00380655996671674 0.00235968283678523 0.00231570611611352 0.00291838559155488 0.00300811800642051 0.00276930588083725 0.00278462341717726 0.00123795964951115 0.00303964174841199 0.00265761243896093 0.00193236516275664 0.00115995132539141 0.00127393056643647 0.00212870166562553 0.00118578671548056 0.00192519934312212 0.00193348537447492 0.00108428166856838 0.003131081612358 0.00386068556487338 0.00392403343025917 0.00213494379513408 0.00139053445865695 0.000658776344546577 0.00231892947763028 0.00334729827646768 0.00300688785793536 0.0028207527120135 0.00218128584624616 0.00256131136869483 0.00283522969529053 0.00210050788021576 0.00163989274079146 0.0018312989382742 0.00164495382686569 0.00195491532742275 0.00238949175966674 0.00168218472609104 0.00120240565505567 0.00135276153324125 0.00182284715520972 0.00173509490638353 0.00167462163281436 0.00162185585656217 0.00169018379279159 0.00163808815467049 0.00165227062703868 0.00183286030330744 0.00271140421199027 0.00296756453610976 0.00284601342779889 0.00424221743304193 0.0110558734926464 0.0140075516596035 0.011140869734544 0.00692641640557657 0.00505975302484202 0.0052891969009988 0.00526649778293835 0.00449735005767627 0.00355416944842784 0.00390546480889833 0.0031069196809844 0.00158803526521935 0.00170973125554047 0.00232485401964427 0.00269536764008858 0.00365788396041806 0.00469615219292607 0.0032795824974233 0.00224257168631424 0.00167145599678588 0.00246128960848225 0.00223226696000164 0.00260526564312558 0.00425212548491987 0.0032686454120751 0.00208533718717811 0.00108369756460375 0.00180549498119146 0.00219252775290769 0.00128357801344934 0.00202622252678381 0.00264131543279427 0.0011732102823526 0.000865947894092824 0.000719160871865927 0.000852083474408264 0.00130402939080029 0.00141533027480859 0.00167496020794481 0.00179832879255141 0.00228837467548836 0.00193837678627466 0.00104292475908635 0.00150195129378787 0.0021700301350523 0.00214395519344817 0.00156475902602149 0.00195031251953935 0.00251232395078198 0.00151844836473542 0.001334255808991 0.00185343434811576 0.00167361510071724 0.00149976711574555 0.00136437932622879 0.00147040996713422 0.0025456897088304 0.00235597474945811 0.00242094129203602 0.00324144001757711 0.00599620320826319 0.0145306764156612 0.0191336221061876 0.0167650983947714 0.0087727439700131 0.00593684428578785 0.00628377520232799 0.00530436424121816 0.00444804106620898 0.00315627054399531 0.00266506643767672 0.00185160126848884 0.00185684526686347 0.00204953621118531 0.00295307534235066 0.00271229708651442 0.0024303193232508 0.00211947339540757 0.00218009451859067 0.00142113420113475 0.0012302125272439 0.00108754100517604 0.00162448878201242 0.00231643804321121 0.00214513977844361 0.0024370513254156 0.00223763855659185 0.00192992414143327 0.00313777075064848 0.00785111932084561 0.01481345291639 0.015983075166486 0.0119098263818999 0.00811840077750318 0.00326884808390251 0.00183430350896613 0.00185375294517793 0.00150725371144745 0.00175904447670019 0.0017871585933855 0.00114717938837834 0.00097563996142762 0.0015496642957213 0.000989033166491052 0.000437902524100274 0.000861849347263811 0.00130670424962894 0.000836621498470568 0.00148690764943566 0.00147816438902292 0.000804361453930561 0.00104277524499015 0.00194132280850142 0.00273167017238574 0.00257302305119547 0.00195238415520021 0.00211884118793782 0.00461045763161667 0.011110325161142 0.0160455299135129 0.015502052786599 0.0113283746953284 0.00784163005048913 0.00470858726375955 0.00212519716320226 0.00164209943078781 0.00304043708309112 0.00291423136338517 0.00210031514681694 0.00299151024617001 0.00462431240246367 0.00279838880335998 0.00141671286428161 0.00243034610303817 0.00409107345938789 0.00202527368175612 0.00224869399723228 0.00261969458058293 0.00310160005650883 0.00156071720881772 0.00174446190704411 0.00177427368474051 0.00189604728394362 0.00210811364508387 0.00329783872835027 0.00428341978545666 0.00499971427724052 0.00770793056733513 0.0139478411902017 0.0148035897551522 0.0114861141117233 0.00681741874271701 0.00272037911866944 0.00226915464627466 0.00177593223540319 0.00144748926674865 0.0023754375488627 0.00335587106685808 0.00285634869517248 0.00231012422057436 0.00164164654879319 0.00251491397541743 0.00274016672198531 0.00264393122432292 0.00288705360863611 0.00239049676529946 0.00233035492664876 0.00167689384163961 0.00150241384983581 0.00144057505440438 0.00205717321943379 0.00108547601937027 0.0015233196266395 0.00520823922441995 0.010644657851936 0.0123363493739803 0.00916492540656528 0.00614361645211487 0.00563302564526628 0.00374475560622863 0.00253762323778693 0.00178682496592509 0.00373981581165266 0.00800729695470336 0.00556964761931356 0.00333737180997447 0.00329598602704956 0.00222087688714414 0.000996675866147629 0.00229044042557204 0.0038157813506128 0.00530507270507664 0.00391992225770741 0.0027714428238755 0.00239397861121177 0.00108093874054606 0.000802506135487141 0.00129107733417009 0.00180079107749498 0.00196054652634521 0.00138340769662652 0.00172291895940217 0.00147981806004807 0.00166094678827212 0.00291060885913627 0.00272641727377932 0.00203341793761649 0.00214082584123027 0.00125831153968296 0.00130844543513981 0.00152624392114365 0.00144450817547453 0.0017688373347511 0.00239954730306733 0.0024254641190271 0.0015734291905457 0.0018235600336362 0.000707568925275714 0.000764557691925817 0.000860419644802503 0.00145586554020629 0.00144877679986771 0.0010985512199374 0.000751670013347368 0.00137397085108897 0.00128474952969713 0.00185706139232296 0.00330894177328423 0.0041616846224419 0.00544121510537306 0.00520592298770603 0.00543931918267721 0.00527707153262685 0.00508612979303719 0.00342579473713393 0.00253925157420838 0.00235682305796047 0.00298997518836197 0.00385177854623953 0.00219818229016069 0.0013745454957494 0.00195833760323504 0.00199720079260768 0.00191934065487764 0.00269607253847864 0.00123973545876021 0.00233536884089249 0.00379948371758928 0.00256896699755528 0.00267303326843459 0.0025720754361084 0.00184321291672738 0.00238201622161437 0.001736526701346 0.00165435775811172 0.00174637980696096 0.00133071428423865 0.00219155825327222 0.00252617378184028 0.00181927767984194 0.00155575150019406 0.00239983524200052 0.00153244327037795 0.00111200310155376 0.00209714854693666 0.00160972970517556 0.00104975255462549];
%		fs=256;		% This is the frame rate of x since x is the OSC of each frame
%		coef=gaussianFilterCoef(fs, fs/50);
%		y=gaussianFilter(x, fs, coef, 1);

%	Roger Jang, 20130707

if nargin<1, selfdemo; return; end
if nargin<4, showPlot=0; end

delay = (length(filterCoef)-1)/2;
y = filter(filterCoef, 1, [x, zeros(1,delay)]);
y = y(delay+1:end);

if showPlot
	time=(0:length(x)-1)/fs;
	figure; plot(time, x, time, y);
	xlabel('Time (sec)'); ylabel('Amplitude');
	legend('Original', 'After filtering');
end

% ====== Self demo
function selfdemo
mObj=mFileParse(which(mfilename));
strEval(mObj.example);
